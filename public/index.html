<html>
    <head>
        <title>
            Web in Sockets
        </title>
        <script type="text/javascript">
            window.onload = function () {
                var conn;
                var msg = document.getElementById("msg");
                var log = document.getElementById("log");

                document.getElementById("form").onsubmit = function () {
                    if (!conn) {
                        return false;
                    }
                    if (!msg.value) {
                        return false;
                    }
                    conn.send(
                        JSON.stringify({
                            email: 'weslleycsil@gmail.com',
                            username: 'weslley',
                            message: msg.value,
                            event: 'msg',
                        })
                    );
                    msg.value = "";
                    return false;
                };

                if (window["WebSocket"]) {
                    conn = new WebSocket("ws://" + document.location.host + "/ws");
                    conn.onclose = function (evt) {
                        console.log("Connection closed - ", evt)
                    };
                    conn.onmessage = function (evt) {
                        console.log("MSG: ",evt);
                    };
                } else {
                    console.log("Your browser does not support WebSockets.")
                }

            };
        </script>
    </head>
    <body>
            <div id="log"></div>
            <form id="form">
                <input type="text" id="msg" size="64">MSG</input> <br>
                <input type="text" id="email" size="64">EMAIL</input> <br>
                <input type="text" id="event" size="64">EVENT</input> <br>
                <input type="text" id="username" size="64">USERNAME</input> <br>

                <input type="submit" value="Send"/>
            </form>
    </body>
</html>