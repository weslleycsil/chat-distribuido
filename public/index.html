<html>
    <head>
        <title>
            Web in Sockets
        </title>
        <script type="text/javascript">
            window.onload = function () {
                var conn;
                var msg = document.getElementById("msg");
                var mail = document.getElementById("mail");
                var evt = document.getElementById("evt");
                var usr = document.getElementById("usr");
                var log = document.getElementById("log");

                document.getElementById("form").onsubmit = function () {
                    if (!conn) {
                        return false;
                    }
                    conn.send(
                        JSON.stringify({
                            Email: mail.value,
                            Username: usr.value,
                            Message: msg.value,
                            Event: evt.value,
                        })
                    );
                    msg.value = "";
                    return false;
                };

                if (window["WebSocket"]) {
                    conn = new WebSocket("ws://" + document.location.host + "/ws");
                    conn.onclose = function (evt) {
                        console.log("Connection closed - ", evt)
                    };
                    conn.onmessage = function (evt) {
                        console.log("MSG: ",evt.data);
                    };
                } else {
                    console.log("Your browser does not support WebSockets.")
                }

            };
        </script>
    </head>
    <body>
            <div id="log"></div>
            <form id="form">
                <input type="text" id="msg" size="64">MSG</input> <br>
                <input type="text" id="mail" size="64">EMAIL</input> <br>
                <input type="text" id="evt" size="64">EVENT</input> <br>
                <input type="text" id="usr" size="64">USERNAME</input> <br>

                <input type="submit" value="Send"/>
            </form>
    </body>
</html>